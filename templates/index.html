<html lang="en">
  <head>
    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="968358953056-2h45jfa9pnc49t8oh5kbbc7cpnlngfnn.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <!-- <script src="static/js/index.js"></script> -->
    <style>
        .center {
            max-width: 500px;
            margin: auto;
        }
    </style>
  </head>
  
  <body>
    <div class="center">
    <div 
        class="g-signin2" 
        data-onsuccess="onSignIn" 
        data-theme="dark"
        data-longtitle="true"
    ></div>

    <h1>Project II GAE</h1>

    <form onSubmit="return processForm(e)" id="califormication" action="#" method="post" enctype="multipart/form-data"> 
        <p>Email to send to</p>
        <input value="" id="text-input" type="text" name="email" disabled />
        <input type="file" name="file" accept="image/*" disabled />  
        <input type = "submit" value="Upload" disabled />  
    </form>  
    <strong> {{ message }} </strong>
    </div>

    <script>
        function processForm(e) {
    if (e.preventDefault) e.preventDefault();
    var auth2 = gapi.auth2.getAuthInstance();
    if (auth2.isSignedIn.get()) {
        return true
    }

    return false;
}

function onSignIn(googleUser) { 
    var i;
    for (i = 0; i < document.getElementsByTagName('input').length; i++) {
        document.getElementsByTagName('input')[i].disabled = false;
    } 

    var profile = googleUser.getBasicProfile();

    document.getElementById('text-input').value = profile.getEmail();

    var a = document.createElement('a');
    a.href = "#";
    a.onclick="signOut()";
    t = "Sign Out";
    a.appendChild(t);
    document.getElementsByClassName("center")[0].appendChild(a);
}

function signOut() {
    var auth2 = gapi.auth2.getAuthInstance();
    auth2.signOut().then(function () {
        var i;
        for (i = 0; i < document.getElementsByTagName('input').length; i++) {
            document.getElementsByTagName('input')[i].disabled = true;
        } 
    });
    window.location.reload(false); 
}
    </script>

  </body>
</html>
